<!DOCTYPE html>
<html lang="pt-br">


<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TAF√≠metro</title>
    <meta name="description" content="Insira os dados do seu TAF/treino e desbrave seu card!" >
    <link rel="stylesheet" href="css/styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Black+Ops+One&display=swap" rel="stylesheet">
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-JD3QNKB49H"></script>
    <script>
        const endLocais = ["localhost", "127.0.0.1", "192.168."];
        const ehLocal = endLocais.some(t => location.hostname.includes(t));
        const temNogtag = (new URLSearchParams(location.search)).has("nogtag");

        if (!ehLocal && !temNogtag) {
            console.log("Ativando gtag...");
            window.dataLayer = window.dataLayer || [];
            function gtag() { dataLayer.push(arguments); }
            gtag('js', new Date());
            gtag('config', 'G-JD3QNKB49H');
        }
        else console.log("Desativando gtag...");
    </script>
</head>

<body>
    <div class="container">
        <h1 style="margin-top: 5px;">‚öìüìä TAF√≠metro <span id="tituloEmojis">üèÉüèª‚Äç‚ôÄÔ∏èüèä</span></h1>
        <p class="instrucao-frase">üìà Insira os dados do seu TAF/treino e desbrave seu card!</p>
        <form id="calcForm">
            <div style="display: flex; gap: 8px; align-items: flex-end;">
                <div style="flex: 1;">
                    <label for="atividade">üèÉ Teste:</label>
                    <select id="atividade" required style="width: 100%; height: 38px;">
                        <option value="corrida2400">Corrida 2.4km</option>
                        <option value="corrida3200">Corrida 3.2km</option>
                        <option value="natacao50" selected>Nata√ß√£o 50m</option>
                        <option value="natacao100">Nata√ß√£o 100m</option>
                        <option value="caminhada4800">Caminhada 4.8km</option>
                    </select>
                </div>
            </div>

            <div id="tempoInput">
                <label for="tempo">üïí Tempo (mm:ss):</label>
                <div style="display: flex; gap: 4px; align-items: baseline;">
                    <select id="tempoMinutos" style="flex: 1;">
                        <option value="00">00</option>
                        <option value="01">01</option>
                        <option value="02">02</option>
                        <option value="03">03</option>
                        <option value="04">04</option>
                        <option value="05">05</option>
                        <option value="06">06</option>
                        <option value="07">07</option>
                        <option value="08">08</option>
                        <option value="09">09</option>
                        <option value="10">10</option>
                        <option value="11">11</option>
                        <option value="12">12</option>
                        <option value="13">13</option>
                        <option value="14">14</option>
                        <option value="15">15</option>
                        <option value="16">16</option>
                        <option value="17">17</option>
                        <option value="18">18</option>
                        <option value="19">19</option>
                        <option value="20">20</option>
                        <option value="21">21</option>
                        <option value="22">22</option>
                        <option value="23">23</option>
                        <option value="24">24</option>
                        <option value="25">25</option>
                        <option value="26">26</option>
                        <option value="27">27</option>
                        <option value="28">28</option>
                        <option value="29">29</option>
                        <option value="30">30</option>
                        <option value="31">31</option>
                        <option value="32">32</option>
                        <option value="33">33</option>
                        <option value="34">34</option>
                        <option value="35">35</option>
                        <option value="36">36</option>
                        <option value="37">37</option>
                        <option value="38">38</option>
                        <option value="39">39</option>
                        <option value="40">40</option>
                        <option value="41">41</option>
                        <option value="42">42</option>
                        <option value="43">43</option>
                        <option value="44">44</option>
                        <option value="45">45</option>
                        <option value="46">46</option>
                        <option value="47">47</option>
                        <option value="48">48</option>
                        <option value="49">49</option>
                        <option value="50">50</option>
                        <option value="51">51</option>
                        <option value="52">52</option>
                        <option value="53">53</option>
                        <option value="54">54</option>
                        <option value="55">55</option>
                        <option value="56">56</option>
                        <option value="57">57</option>
                        <option value="58">58</option>
                        <option value="59">59</option>
                        <option value="60">60</option>
                    </select>
                    <span style="font-weight: bold; margin: 0 2px;">:</span>
                    <select id="tempoSegundos" style="flex: 1; ">
                        <option value="00">00</option>
                        <option value="01">01</option>
                        <option value="02">02</option>
                        <option value="03">03</option>
                        <option value="04">04</option>
                        <option value="05">05</option>
                        <option value="06">06</option>
                        <option value="07">07</option>
                        <option value="08">08</option>
                        <option value="09">09</option>
                        <option value="10">10</option>
                        <option value="11">11</option>
                        <option value="12">12</option>
                        <option value="13">13</option>
                        <option value="14">14</option>
                        <option value="15">15</option>
                        <option value="16">16</option>
                        <option value="17">17</option>
                        <option value="18">18</option>
                        <option value="19">19</option>
                        <option value="20">20</option>
                        <option value="21">21</option>
                        <option value="22">22</option>
                        <option value="23">23</option>
                        <option value="24">24</option>
                        <option value="25">25</option>
                        <option value="26">26</option>
                        <option value="27">27</option>
                        <option value="28">28</option>
                        <option value="29">29</option>
                        <option value="30">30</option>
                        <option value="31">31</option>
                        <option value="32">32</option>
                        <option value="33">33</option>
                        <option value="34">34</option>
                        <option value="35">35</option>
                        <option value="36">36</option>
                        <option value="37">37</option>
                        <option value="38">38</option>
                        <option value="39">39</option>
                        <option value="40">40</option>
                        <option value="41">41</option>
                        <option value="42">42</option>
                        <option value="43">43</option>
                        <option value="44">44</option>
                        <option value="45">45</option>
                        <option value="46">46</option>
                        <option value="47">47</option>
                        <option value="48">48</option>
                        <option value="49">49</option>
                        <option value="50">50</option>
                        <option value="51">51</option>
                        <option value="52">52</option>
                        <option value="53">53</option>
                        <option value="54">54</option>
                        <option value="55">55</option>
                        <option value="56">56</option>
                        <option value="57">57</option>
                        <option value="58">58</option>
                        <option value="59">59</option>
                    </select>
                </div>
            </div>

            <div style="display: flex; gap: 8px; align-items: flex-end;">
                <div style="flex: 1;">
                    <label for="sexo">üë© Sexo:</label>
                    <select id="sexo" required>
                        <option value="M">Masculino</option>
                        <option value="F" selected>Feminino</option>
                    </select>
                </div>
            </div>

            <div style="display: flex; gap: 8px; align-items: flex-end;">
                <div style="flex: 1;">
                    <label for="idade" style="margin-bottom: 4px; display: block;">üî¢ Idade:</label>
                    <input type="number" id="idade" value="35" min="18" required style="width: 90%;">
                </div>
                <div style="width: 150px;">
                    <label for="calcularMaior100" style="font-size: 0.8em; margin-bottom: 4px; display: block;text-align: center;">üöÄ *Calcular nota > 100?</label>
                    <select id="calcularMaior100"
                        style="padding: 4px 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 0.9rem;">
                        <option value="nao">N√£o</option>
                        <option value="sim">Sim</option>
                    </select>
                </div>
            </div>

            <!-- <button type="submit">‚ö°Desbrava !</button> -->
            <button type="submit"
                style="font-family: 'Black Ops One', sans-serif; font-size: 14px; margin-top: 20px">‚ö°DESBRAVE !</button>
        </form>

        <div id="resultado">
            <div id="nota">
                <div class="share-card" id="shareCard" style="display: none;">
                    <div class="share-top" style="position: relative; text-align: center; display: flex; justify-content: center; align-items: center;">
                        <span class="card-decoration" style="position: absolute; left: calc(50% - 63.5px); height: 30px; width: auto; top: 50%; transform: translateY(-50%);">‚è±Ô∏è</span>
                        <div>
                            <span class="main">TAF√≠metro<span class="rev">CGCFN<br/>108 REV1</span></span>
                            <div class="card-date" id="cardDate" style="font-size:.7rem;font-weight:lighter;opacity:.8;margin-top: 2px;">
                            </div>
                        </div>
                    </div>
                    <div id="scoreAtividade"
                        style="display: flex; align-items: center; justify-content: center; /*font-family: 'Inter', sans-serif; */font-size: 1rem; font-weight: 700; text-align: center; color: #666; padding: 3px 20px 4px 20px; margin: 7px -10px 0px -10px; background-color: rgba(255, 255, 255, 0.10); width: calc(100% + 20px); box-sizing: border-box; position: relative;">
                        <span id="cardEmojiDireita" style="margin-right: 2px;"></span><span
                            id="scoreAtividadeText"></span>
                    </div>
                    <div class="score-big" id="scoreBig"></div>
                    <div id="scoreFaixaEtaria"
                        style="display: flex; justify-content: center; /*font-family: 'Inter', sans-serif; */font-size: 0.8rem; font-weight: 600; text-align: center; color: #888; padding: 0px 10px;margin: 0px 0px 12px 0px;">
                    </div>
                    <div class="zone-small" id="zoneSmall"></div>
                    <div class="card-meta"
                        style="display:flex;gap:12px;align-items:center;justify-content:center;padding: 0px 12px 0px 10px;margin-top: 2px">
                        <div class="meta-item">
                            <div style="font-size:.75rem;font-weight:600;opacity:1">üïí Tempo</div>
                            <div style="font-size:.95rem;font-weight:600" id="cardTempo"></div>
                        </div>
                        <div class="meta-item">
                            <div style="font-size:.75rem;font-weight:600;opacity:1">‚û°Ô∏è Pace</div>
                            <div style="font-size:.85rem;font-weight:600;" id="cardPace"></div>
                        </div>
                    </div>
                    <div class="card-corner card-corner-left"></div>
                    <div class="card-corner card-corner-right"></div>
                </div>
            </div>

            <div id="opcoesCard"
                style="display: none; justify-content: center; align-items: center; margin: 10px 0; gap: 20px;">
                <div style="display: flex; align-items: center;">
                    <span style="margin-right: 10px; font-weight: bold;">Mostrar Pace:</span>
                    <label class="switch" title="Mostrar/ocultar pace">
                        <input type="checkbox" id="togglePace" checked>
                        <span class="slider round"></span>
                    </label>
                </div>
                <div style="display: flex; align-items: center;">
                    <span style="margin-right: 10px; font-weight: bold;">Mostrar Faixa Et√°ria:</span>
                    <label class="switch" title="Mostrar/ocultar faixa et√°ria">
                        <input type="checkbox" id="toggleFaixa" checked>
                        <span class="slider round"></span>
                    </label>
                </div>
            </div>

            <div id="cardActions" style="display:none;gap:8px; width:100%; align-items:stretch;">
                <button class="compose-export" type="button" id="copyCardBtn" style="flex:1 1 0;">üìã Compartilhar
                    Card</button>
                <button class="compose-export" type="button" id="downloadCardBtn" style="flex:1 1 0;">üíæ Baixar
                    Card</button>
            </div>

        </div>

        <div id="compositor" style="margin-top: 45px; display: none;">
            <h3
                style="font-size: clamp(1rem, 4vw, 1.5rem); white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                Combine com o print do seu app de esportes:</h3>
            <div class="compose-controls">
                <input type="file" id="composeInput" accept="image/*" class="compose-upload">
                <label id="composeScaleRow" for="composeScale"
                    style="white-space: nowrap; display:none; align-items:center; gap:6px; width:100%;">
                    Tamanho do card:
                    <input type="range" id="composeScale" min="35" max="160" value="100" step="1" style="width:100%;">
                    <span id="composeScaleLabel">100%</span>
                </label>
                <div id="borderRadiusControls" style="display: none; font-size: 0.8em; gap: 8px; flex-wrap: wrap;">
                    <label id="borderRadiusLabel" style="white-space: nowrap;">
                        Arredondar canto:</label>
                    <div style="display: flex; gap: 8px; width: 100%;">
                        <div style="flex: 1;">
                            <label style="margin-bottom: 4px;">Superior
                                esquerdo</label>
                            <input type="range" class="border-radius-control" data-corner="top-left" min="0" max="50"
                                value="10" style="width: 100%;">
                        </div>
                        <div style="flex: 1;">
                            <label style="margin-bottom: 4px;">Superior
                                direito</label>
                            <input type="range" class="border-radius-control" data-corner="top-right" min="0" max="50"
                                value="10" style="width: 100%;">
                        </div>
                    </div>
                    <div style="display: flex; gap: 8px; width: 100%;">
                        <div style="flex: 1;">
                            <label style="margin-bottom: 4px;">Inferior
                                esquerdo</label>
                            <input type="range" class="border-radius-control" data-corner="bottom-left" min="0" max="50"
                                value="10" style="width: 100%;">
                        </div>
                        <div style="flex: 1;">
                            <label style="margin-bottom: 4px;">Inferior
                                direito</label>
                            <input type="range" class="border-radius-control" data-corner="bottom-right" min="0"
                                max="50" value="10" style="width: 100%;">
                        </div>
                    </div>
                    <div style="display: flex; gap: 8px; width: 100%; margin-top: 5px;">
                        <button type="button" id="resetBorderRadius" class="compose-export"
                            style="flex: 1; padding: 5px; font-size: 0.8em;">‚Ü∫ Redefinir Bordas</button>
                    </div>
                </div>
                <div id="composeActions" style="display:none; gap:8px; width:100%; align-items:stretch;">
                    <button type="button" id="composeShare" class="compose-export" style="flex:1 1 0;" disabled>üì§
                        Compartilhar Print</button>
                    <button type="button" id="composeExport" class="compose-export" style="flex:1 1 0;" disabled>üíæ
                        Baixar Print</button>
                </div>
            </div>
            <div id="composeWrap" style="position: relative; display: inline-block;">
                <img id="composeImg" alt="" style="max-width: 100%; height: auto; display: none;">
                <div id="composeOverlay"
                    style="position: absolute; inset: 0; pointer-events: auto; visibility: hidden;"></div>
            </div>
        </div>

        <hr style="margin-top: 20px;" />

        <!-- Nova tabela de refer√™ncia por nota -->
        <div class="tabela-notas">
            <h2>Nota | Tempo</h2>
            <div class="table-responsive">
                <table>
                    <thead>
                        <tr>
                            <th>Nota</th>
                            <th>Tempo</th>
                            <th>Pace</th>
                        </tr>
                    </thead>
                    <tbody id="tabelaNotas">
                        <!-- preenchido via JavaScript -->
                        <!-- Estrutura est√°tica: linhas ser√£o adicionadas dinamicamente -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Nova se√ß√£o de gr√°ficos -->
        <div class="seccion-graficos">
            <h2 id="titulo-graficos">Gr√°fico: Nota vs Tempo</h2>
            <!-- <p class="muted">Linhas para Homens (M) e Mulheres (F).</p> -->

            <div class="grid-graficos">
                <div class="grafico-wrap">
                    <h4 id="grafico-titulo">Corrida 2.4km</h4>
                    <canvas id="chart-atividade" width="400" height="250"></canvas>
                </div>
            </div>
        </div>
        <!-- /Nova se√ß√£o de gr√°ficos -->

        <div class="tabela-referencia">
            <h2 id="titulo-referencia">Tempos de Refer√™ncia</h2>
            <div class="table-responsive">
                <table>
                    <thead id="tabelaReferenciaHeader">
                        <tr>
                            <th>Faixa Et√°ria</th>
                            <th>Tempo Masc</th>
                            <th>Tempo Fem</th>
                        </tr>
                    </thead>
                    <tbody id="tabelaTemposReferencia">
                        <!-- preenchido via JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script src="js/calc.js"></script>
    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <footer>
        <sub>TAF√≠metro | <a href="mailto:jonathan.elias@marinha.mil.br">jonathan.elias@marinha.mil.br</a></sub>
        <sub>Publica√ß√£o base: CGCFN 108 REV1 (2021)</sub>
        <sub style="white-space: break-spaces;margin-top:10px">* Estimativa baseada na taxa de varia√ß√£o da nota em fun√ß√£o do tempo no intervalo de 90 a 100 pontos do teste selecionado.</sub>
    </footer>

    <!-- Biblioteca para capturar o div como imagem -->
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <script src="js/tabelasPontuacao.js"></script>
    <script src="js/app.js"></script>
</body>

</html>